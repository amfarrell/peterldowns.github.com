<!doctype HTML>
<html>

<head>
  <meta charset='utf-8'>
  <meta name='viewport' content='width=device-width'>
  <title> How to submit a package to PyPI &#8212; Peter Downs </title>

  <link href='//fonts.googleapis.com/css?family=Lato:700italic,400,400italic,700'
        rel='stylesheet'
        type='text/css' />
  <link href='//fonts.googleapis.com/css?family=Inconsolata'
        rel='stylesheet'
        type='text/css' />
  <link href='/static/css/clearness.css'
        rel='stylesheet'
        type='text/css' />
  <link href='/static/css/index.css'
        rel='stylesheet'
        type='text/css' />
  <link href="/static/css/highlightjs.css"
        rel="stylesheet"
        type='text/css'/>

  <script type='text/javascript'>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-40701023-1', 'peterdowns.com');
    ga('require', 'displayfeatures');
    ga('send', 'pageview');
  </script>
  <script src="/static/js/highlight.js"></script>
</head>

<body>
  <div id='page-wrap'>
    <div id="header">
        <h1 id='title'> Peter Downs </h1>
        <ul id='nav'>
            <li><a href='/'>Writing</a></li>
            <li><a href='/about.html'>About</a></li>
            <li><a href='https://github.com/peterldowns' target='_blank'>Github &#8594;</a></li>
        </ul>
    </div>
    <div id='content'>
      <div class='post'>
        <h1>How to submit a package to PyPI</h1>
<hr />
<p>The other month a coworker of mine wanted to distribute
<a href="http://PyPI.python.org/PyPI/locu/0.1">a small wrapper</a>
he'd written for the <a href="http://dev.locu.com/">Locu API</a>.
Instead of forcing developers to clone his repository, he
wanted them to be able install with a single command:
<code>pip install locu</code>. He wasn't sure how to go about this so
I wrote up a quick guide, which I'm publishing below
because I haven't found any other guides for this particular
use case (python library hosted on github).</p>
<h2>What is <a href="http://pypi.python.org">PyPI</a>?</h2>
<p>From the official website:</p>
<blockquote>
<p><strong>PyPI</strong> &#8212; the Python Package Index</p>
<p>The Python Package Index is a repository of software for the
Python programming language.</p>
</blockquote>
<p>Written something cool? Want others to be able to install it with
<code>easy_install</code> or <code>pip</code>? Put your code on PyPI. It's a big list of
python packages that you absolutely <em>must</em> submit your package to
for it to be easily one-line installable.</p>
<h2>Instructions</h2>
<p>The good news is that submitting to PyPI is simple in theory:
just sign up and upload your code, all for free. The bad news
is that in practice it's a little bit more complicated than that.
The <em>other</em> good news is that I've written this guide, and that
if you're stuck, you can always refer to
<a href="http://wiki.python.org/moin/CheeseShopTutorial#Submitting_Packages_to_the_Package_Index">the official documentation</a>.</p>
<p>I've written this guide with the following assumptions:</p>
<ul>
<li>The module/library/package that you're submitting is called <code>mypackage</code>.</li>
<li><code>mypackage</code> is hosted on <a href="http://github.com">github</a>.</li>
</ul>
<h3>Create your accounts</h3>
<p>On <a href="http://pypi.python.org/pypi?%3Aaction=register_form">PyPI Live</a> and also
on <a href="http://testpypi.python.org/pypi?%3Aaction=register_form">PyPI Test</a>. You must create an
account in order to be able to upload your code. I recommend using the same email/password for
both accounts, just to make your life easier when it comes time to push.</p>
<h3>Create a <code>.pypirc</code> configuration file</h3>
<p>This file holds your information for authenticating with PyPI.</p>
<pre><code>    [distutils] # this tells distutils what package indexes you can push to
    index-servers =
        pypi # the live PyPI
        pypitest # test PyPI

    [pypi] # authentication details for live PyPI
    repository: https://pypi.python.org/pypi
    username: {{your_username}}
    password: {{your_password}}

    [pypitest] # authentication details for test PyPI
    repository: https://testpypi.python.org/pypi
    username: {{your_username}}
</code></pre>
<p>This is just to make your life easier, so that when it comes time to upload you
don't have to type/remember your username and password. Make sure to put this file
in your home folder.</p>
<h3>Prepare your package</h3>
<p>Every package on PyPI needs to have a file called <code>setup.py</code> at
the root of the directory. If your'e using a markdown-formatted read me file
you'll also need a <code>setup.cfg</code> file. Also, you'll want a <code>LICENSE.txt</code> file
describing what can be done with your code. So if I've been working on a
library called <code>mypackage</code>,  my directory structure would look like this:</p>
<pre><code>    root-dir/   # arbitrary working directory name
        setup.py
        setup.cfg
        LICENSE.txt
        README.md
        mypackage/
            __init__.py
            foo.py
            bar.py
            baz.py
</code></pre>
<p>Here's a breakdown of what goes in which file:</p>
<h4><code>setup.py</code></h4>
<p>This is metadata about your library.</p>
<pre><code>from distutils.core import setup
setup(
  name = 'mypackage',
  packages = ['mypackage'], # this must be the same as the name above
  version = '0.1',
  description = 'A random test lib',
  author = 'Peter Downs',
  author_email = 'peterldowns@gmail.com',
  url = 'https://github.com/peterldowns/mypackage', # use the URL to the github repo
  download_url = 'https://github.com/peterldowns/mypackage/tarball/0.1', # I'll explain this in a second
  keywords = ['testing', 'logging', 'example'], # arbitrary keywords
  classifiers = [],
)
</code></pre>
<p>The <code>download_url</code> is a link to a hosted file with your repository's code.
Github will host this for you, but only if you
create a <a href="http://git-scm.com/book/en/Git-Basics-Tagging"><code>git tag</code></a>. In your
repository, type: <code>git tag 0.1 -m "Adds a
tag so that we can put this on PyPI."</code>. Then, type <code>git tag</code> to show a
list of tags &#8212; you should see <code>0.1</code> in the list. Type <code>git push --tags origin
master</code> to update your code on Github with the latest tag information. Github
creates tarballs for download at <code>https://github.com/{username}/{module_name}/tarball/{tag}</code>.</p>
<h4><code>setup.cfg</code></h4>
<p>This tells PyPI where your README file is.</p>
<pre><code>    [metadata]
    description-file = README.md
</code></pre>
<p>This is necessary if you're using a markdown readme file. At upload time, you
may still get some errors about the lack of a readme &#8212; don't worry about it.
If you don't <strong>have</strong> to use a markdown README file, I would recommend using
<a href="http://sphinx-doc.org/rest.html">reStructuredText (REST)</a> instead.</p>
<h4><code>LICENSE.txt</code></h4>
<p>This file will contain whichver license you want your code to have. I tend to
use the <a href="http://opensource.org/licenses/MIT">MIT license</a>.</p>
<h3>Upload your package to PyPI Test</h3>
<p>Run:</p>
<pre><code>python setup.py register -r pypitest
</code></pre>
<p>This will attempt to register your package against PyPI's test server, just to make sure you've
set up everything correctly.</p>
<p>Then, run:</p>
<pre><code>python setup.py sdist upload -r pypitest
</code></pre>
<p>You should get no errors, and should also now be able to see your library in the
<a href="https://testpypi.python.org/pypi">test PyPI repository</a>.</p>
<h3>Upload to PyPI Live</h3>
<p>Once you've successfully uploaded to PyPI Test, perform the same steps but point to
the live PyPI server instead. To register, run:</p>
<pre><code>python setup.py register -r pypi
</code></pre>
<p>Then, run:</p>
<pre><code>python setup.py sdist upload -r pypi
</code></pre>
<p>and you're done! Congratulations on successfully publishing your first package!</p>
      </div>
    </div>
  </div>
</body>

<script type="text/javascript">
  var codeBlocks = document.getElementsByTagName("pre");
  for (var i = 0; i < codeBlocks.length; i++) {
    var block = codeBlocks[i];
    hljs.highlightBlock(block);
  };
</script>

</html>
